(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{20:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var n={name:"CancelButton",props:{text:{type:String,default:"Batal"}}},r=a(1),s=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CButton",{staticClass:"px-3",attrs:{color:"light"},on:{click:function(e){return t.$emit("click")}}},[a("CIcon",{staticClass:"mr-1",attrs:{name:"cil-x-circle"}}),t._v("\n  "+t._s(t.text)+"\n")],1)}),[],!1,null,null,null).exports},21:function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));var n=a(9),r={props:{accessLevel:{type:String,default:n.a.manage}},computed:{canManage:function(){return this.accessLevel===n.a.manage},canSupervise:function(){return this.accessLevel===n.a.supervise},canReport:function(){return this.accessLevel===n.a.report},canView:function(){return this.accessLevel===n.a.view}}}},230:function(t,e,a){"use strict";a.r(e);var n=a(4),r=a(22),s=a(8),i=a(13),o=a.n(i),u=a(36),l=a(5),c=a(20),d=a(11),f=a(12),p=a(32),m=a(57),v=a(21),h=a(59),b=a(15);function _(t,e,a,n,r,s,i){try{var o=t[s](i),u=o.value}catch(t){return void a(t)}o.done?e(u):Promise.resolve(u).then(n,r)}function g(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){_(s,n,r,i,o,"next",t)}function o(t){_(s,n,r,i,o,"throw",t)}i(void 0)}))}}function y(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function S(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?y(Object(a),!0).forEach((function(e){P(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function P(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var O={description:"",due_date:null,status:2,note:null,assignees:[],epic_id:null,action_plan_category_id:null,streams:[],areas:[],sub_areas:[]},A={name:"SelfAssessmentActionPlanForm",components:{CancelButton:c.a,Histories:m.a,SaveButton:d.a,ValidatedInput:f.a,ValidatedSelect:p.a},mixins:[v.a,h.a,b.a],props:{assigneeOptions:{type:Array,default:function(){return[]}},streamOptions:{type:Array,default:function(){return[]}},statusOptions:{type:Array,default:function(){return[]}},categoryOptions:{type:Array,default:function(){return[]}},histories:{type:Array,default:function(){return[]}}},data:function(){return{areas:[],subAreas:[]}},methods:{updateSelectedStreams:function(t){this.formData=S({},this.formData,{streams:t}),this.areas=[],this.subAreas=[],this.formData.areas=[],this.formData.sub_areas=[],1===t.length&&this.getAreas(t[0].value)},updateSelectedAreas:function(t){this.formData=S({},this.formData,{areas:t}),this.subAreas=[],this.formData.sub_areas=[],1===t.length&&this.getSubAreas(t[0].value)},getAreas:function(t){var e=this;return g(o.a.mark((function a(){var n,r;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,l.a.getSelfAssessmentAreas({query:{stream_id:t}});case 3:n=a.sent,r=n.data,e.areas=r.data,a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),e.areas=[];case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()},getSubAreas:function(t){var e=this;return g(o.a.mark((function a(){var n,r;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,l.a.getSelfAssessmentSubAreas({query:{area_id:t}});case 3:n=a.sent,r=n.data,e.subAreas=r.data,a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),e.subAreas=[];case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()},getOptions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this[t].map((function(t){return{value:t.id,label:t.name}}))},formatBeforeEdit:function(t){return 1===t.streams.length&&this.getAreas(t.streams[0].value),1===t.areas.length&&this.getSubAreas(t.areas[0].value),S({},this.getInitialFormData(),{},t,{status:this.statusOptions.find((function(e){return e.value===t.status})),action_plan_category_id:t.category?this.categoryOptions.find((function(e){return e.value===t.category.id})):null,assignees:t.assignees.map((function(t){return{value:t.id,label:t.name}})),streams:t.streams.map((function(t){return{value:t.id,label:t.name}})),areas:t.areas.map((function(t){return{value:t.id,label:t.name}})),sub_areas:t.sub_areas.map((function(t){return{value:t.id,label:t.name}}))})},formatBeforeSave:function(t){return S({},t,{due_date:Object(u.a)(new Date(t.due_date),"yyyy-MM-dd"),assignees:t.assignees.map((function(t){return t.value})),streams:t.streams.map((function(t){return t.value})),areas:t.areas.map((function(t){return t.value})),sub_areas:t.sub_areas.map((function(t){return t.value})),status:t.status.value,action_plan_category_id:t.action_plan_category_id?t.action_plan_category_id.value:null})},beforeReset:function(){this.$refs.formObserver.reset(),this.areas=[],this.subAreas=[]},beforeSave:function(){return this.$refs.formObserver.validate()},getInitialFormData:function(){return S({},O,{status:this.statusOptions.length?this.statusOptions[0]:null})}},formTitle:"Action Plan"},w=a(1),D=Object(w.a)(A,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ValidationObserver",{ref:"formObserver",attrs:{slim:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.valid;return[a("CModal",{attrs:{title:t.title,show:t.show,"close-on-backdrop":!1,centered:""},on:{"update:show":t.updateShow},scopedSlots:t._u([{key:"footer-wrapper",fn:function(){return[a("div",{staticClass:"p-3"},[a("SaveButton",{staticClass:"float-right",attrs:{disabled:!n},on:{click:t.save}}),t._v(" "),a("CancelButton",{staticClass:"float-right mr-2",on:{click:function(e){return t.updateShow(!1)}}})],1)]},proxy:!0}],null,!0)},[a("CForm",[a("ValidatedInput",{attrs:{disabled:!t.canManage,type:"textarea",label:"Action Plan",rules:"required|max:1000"},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}}),t._v(" "),a("ValidatedInput",{attrs:{disabled:!t.canManage,"disabled-dates":t.disabledDueDates,type:"date",label:"Target Selesai",rules:"required"},model:{value:t.formData.due_date,callback:function(e){t.$set(t.formData,"due_date",e)},expression:"formData.due_date"}}),t._v(" "),a("ValidatedSelect",{attrs:{disabled:!t.canManage&&!t.canSupervise,options:t.assigneeOptions,placeholder:"Pilih PIC",label:"PIC",multiple:""},model:{value:t.formData.assignees,callback:function(e){t.$set(t.formData,"assignees",e)},expression:"formData.assignees"}}),t._v(" "),a("ValidatedSelect",{attrs:{value:t.formData.streams,disabled:!t.canManage&&!t.canSupervise,options:t.streamOptions,placeholder:"Pilih Stream",label:"Stream",multiple:""},on:{input:t.updateSelectedStreams}}),t._v(" "),a("ValidatedSelect",{attrs:{value:t.formData.areas,disabled:!t.canManage&&!t.canSupervise||!t.areas.length,options:t.getOptions("areas"),placeholder:"Pilih Area",label:"Area",multiple:""},on:{input:t.updateSelectedAreas}}),t._v(" "),a("ValidatedSelect",{attrs:{disabled:!t.canManage&&!t.canSupervise||!t.subAreas.length,options:t.getOptions("subAreas"),placeholder:"Pilih Sub Area",label:"Sub Area",multiple:""},model:{value:t.formData.sub_areas,callback:function(e){t.$set(t.formData,"sub_areas",e)},expression:"formData.sub_areas"}}),t._v(" "),a("ValidatedSelect",{attrs:{options:t.statusOptions,placeholder:"Pilih Status",label:"Status",rules:"required"},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}}),t._v(" "),a("ValidatedSelect",{attrs:{options:t.categoryOptions,placeholder:"Pilih Kategori",label:"Kategori"},model:{value:t.formData.action_plan_category_id,callback:function(e){t.$set(t.formData,"action_plan_category_id",e)},expression:"formData.action_plan_category_id"}}),t._v(" "),a("ValidatedInput",{attrs:{type:"textarea",label:"Catatan",rules:"max:1000"},model:{value:t.formData.note,callback:function(e){t.$set(t.formData,"note",e)},expression:"formData.note"}})],1),t._v(" "),a("Histories",{staticClass:"mt-4",attrs:{title:"Action Plan",histories:t.histories}})],1)]}}])})}),[],!1,null,null,null).exports,C=a(23),k=a(17),x=a(14),j=a(7),E=a(29),T=a(37),$={name:"SelfAssessmentActionPlanTable",components:{DeleteButton:C.a,EditButton:k.a,TableNoItem:x.a,ContentPanel:j.a},mixins:[E.a,T.a],props:{actionPlans:{type:Array,default:function(){return[]}},statusOptions:{type:Array,default:function(){return[]}}},computed:{statuses:function(){return this.statusOptions.reduce((function(t,e){return t[e.value]=e.label,t}),{})},statusColors:function(){return this.statusOptions.reduce((function(t,e){return t[e.value]=e.color,t}),{})}},fields:[{label:"Action Plan",key:"description"},{label:"Target Selesai",key:"due_date"},{label:"Status",key:"status"},{label:"Kategori",key:"category"},{label:"PIC",key:"assignees"},{label:"Stream",key:"streams"},{label:"Area",key:"areas"},{label:"Sub Area",key:"sub_areas"},{label:"Tgl. Dibuat",key:"created_at"},{label:"Update Terakhir",key:"updated_at"},{label:"",key:"actions"}]},B=Object(w.a)($,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentPanel",{attrs:{"table-content":""}},[a("CDataTable",{attrs:{items:t.actionPlans,fields:t.$options.fields,hover:""},scopedSlots:t._u([{key:"status",fn:function(e){var n=e.item;return[a("td",[t.statuses[n.status]?a("CBadge",{attrs:{color:t.statusColors[n.status],shape:"pill"}},[t._v("\n          "+t._s(t.statuses[n.status]||"-")+"\n        ")]):[t._v("\n          -\n        ")]],2)]}},{key:"category",fn:function(e){var n=e.item;return[a("td",[t._v("\n        "+t._s(n.category?n.category.name:"-")+"\n      ")])]}},{key:"assignees",fn:function(e){var n=e.item;return[a("td",[t._v("\n        "+t._s(n.assignees.length?n.assignees.map((function(t){return t.name})).join(", "):"-")+"\n      ")])]}},{key:"streams",fn:function(e){var n=e.item;return[a("td",[t._v("\n        "+t._s(n.streams.length?n.streams.map((function(t){return t.name})).join(", "):"-")+"\n      ")])]}},{key:"areas",fn:function(e){var n=e.item;return[a("td",[t._v("\n        "+t._s(n.areas.length?n.areas.map((function(t){return t.name})).join(", "):"-")+"\n      ")])]}},{key:"sub_areas",fn:function(e){var n=e.item;return[a("td",[t._v("\n        "+t._s(n.sub_areas.length?n.sub_areas.map((function(t){return t.name})).join(", "):"-")+"\n      ")])]}},{key:"created_at",fn:function(e){var n=e.item;return[a("td",[t._v("\n        "+t._s(t._f("toHumanDate")(n.created_at))+"\n      ")])]}},{key:"updated_at",fn:function(e){var n=e.item;return[a("td",[t._v("\n        "+t._s(t._f("toHumanDate")(n.updated_at))+"\n      ")])]}},{key:"actions",fn:function(e){var n=e.item;return[a("td",[a("CButtonGroup",[t.editButtonShown?a("EditButton",{on:{click:function(e){return t.edit(n)}}}):t._e(),t._v(" "),t.deleteButtonShown?a("DeleteButton",{on:{click:function(e){return t.remove(n)}}}):t._e()],1)],1)]}}])},[a("TableNoItem",{attrs:{slot:"no-items-view"},slot:"no-items-view"})],1),t._v(" "),a("CPagination",{attrs:{"active-page":t.currentPage,pages:t.pages,align:"center"},on:{"update:activePage":t.changePage}})],1)}),[],!1,null,null,null).exports,M=a(18),N=a(3),F=a(0),I=a(2),L=a(6),V=a(9);function H(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function R(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?H(Object(a),!0).forEach((function(e){q(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function q(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var G={name:"SelfAssessmentActionPlan",components:{CreateButton:r.a,PageTitle:s.a,ActionPlanForm:D,ActionPlanTable:B},mixins:[M.a],computed:R({},Object(n.e)(N.a,["actionPlanCategories","actionPlanStatusOptions","assigneeOptions"]),{},Object(n.e)(N.e,{actionPlans:"actionPlans",meta:"actionPlansMeta",actionPlanHistories:"actionPlanHistories",streams:"streams"}),{streamOptions:function(){return this.streams.data.map((function(t){return{value:t.id,label:t.name}}))},categoryOptions:function(){return this.actionPlanCategories.data.map((function(t){return{value:t.id,label:t.name}}))},canCreate:function(){return this.$root.hasPermissionTo(L.a.MANAGE_SELF_ASSESSMENT_ACTION_PLAN)},canEdit:function(){return this.$root.hasAnyPermissionTo([L.a.MANAGE_SELF_ASSESSMENT_ACTION_PLAN,L.a.REPORT_SELF_ASSESSMENT_ACTION_PLAN])},formAccessLevel:function(){var t=this.$root,e=t.hasPermissionTo,a=t.hasRole;return e(L.a.MANAGE_SELF_ASSESSMENT_ACTION_PLAN)?V.a.manage:a("supervisor")?V.a.supervise:e(L.a.REPORT_SELF_ASSESSMENT_ACTION_PLAN)?V.a.report:""}}),methods:R({},Object(n.b)(N.a,[F.w,F.y,F.D]),{},Object(n.b)(N.e,{getPaginatedData:function(t){return t(F.z,this.currentPage)},handleCreate:F.b,handleUpdate:F.db,handleRemove:function(t,e){return t(F.m,e.id)},getActionPlanHistories:F.x,getStreams:F.O}),{},Object(n.d)(N.e,[I.b]),{prepareData:function(){var t=this;return Promise.all([this.getActionPlanCategories(),this.getActionPlanStatusOptions(),this.getAssigneeOptions(),this.getPaginatedData(),this.getStreams()]).catch((function(){return t.$root.showGeneralErrorNotification()}))},beforeCreate:function(){this.setActionPlanHistories([])},beforeEdit:function(t){this.getActionPlanHistories(t.id)},setDeleteConfirmationPayload:function(t){return{title:"action plan",data:t}},formatCreateSuccessMessage:function(){return"Action plan berhasil ditambahkan"},formatUpdateSuccessMessage:function(){return"Action plan berhasil diperbarui"},formatRemovalSuccessMessage:function(){return"Action plan berhasil dihapus"},formatRemovalFailedMessage:function(t,e){return e.response.data.errors.join(" ")}})},K=Object(w.a)(G,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("PageTitle",{attrs:{title:"Action Plan Penguatan Kinerja Proses"},scopedSlots:t._u([{key:"actions",fn:function(){return[t.canCreate?a("CreateButton",{attrs:{text:"Tambah Action Plan"},on:{click:t.create}}):t._e()]},proxy:!0}])}),t._v(" "),a("ActionPlanTable",{attrs:{"action-plans":t.actionPlans,"status-options":t.actionPlanStatusOptions,"current-page":t.currentPage,pages:t.pages,"delete-button-shown":t.canCreate,"edit-button-shown":t.canEdit},on:{edit:t.edit,remove:t.toggleDeleteConfirmation,changePage:t.changePage}}),t._v(" "),a("ActionPlanForm",{attrs:{show:t.showForm,"edit-mode":t.editModeForm,"edited-data":t.editFormData,"assignee-options":t.assigneeOptions,"stream-options":t.streamOptions,"status-options":t.actionPlanStatusOptions,"category-options":t.categoryOptions,"access-level":t.formAccessLevel,histories:t.actionPlanHistories.data},on:{"update:show":function(e){t.showForm=e},save:t.save}})],1)}),[],!1,null,null,null);e.default=K.exports},29:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var n={props:{editButtonShown:{type:Boolean,default:!0},deleteButtonShown:{type:Boolean,default:!0}},computed:{fields:function(){return this.$options.fields?this.editButtonShown||this.deleteButtonShown?this.$options.fields:this.$options.fields.filter((function(t){return"actions"!==t.key})):[]}},methods:{edit:function(t){this.$emit("edit",t)},remove:function(t){this.$emit("remove",t)}}}},32:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var n={name:"ValidatedInput",props:{options:{type:Array,default:function(){return[]}},placeholder:{type:String,default:""},rules:{type:String,default:""},label:{type:String,default:""},value:{default:null}}},r=a(1),s=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ValidationProvider",{attrs:{rules:t.rules},scopedSlots:t._u([{key:"default",fn:function(e){e.validated;var n=e.errors;return[a("div",{staticClass:"form-group",attrs:{role:"group"}},[a("div",[t._v("\n      "+t._s(t.label)+"\n    ")]),t._v(" "),a("VueSelect",t._b({class:{"is-invalid":n.length},attrs:{value:t.value,options:t.options,placeholder:t.placeholder},on:{input:function(e){return t.$emit("input",e)}}},"VueSelect",t.$attrs,!1)),t._v(" "),a("div",{staticClass:"invalid-feedback"},[t._v("\n      "+t._s(n[0])+"\n    ")])],1)]}}])})}),[],!1,null,null,null).exports},37:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var n={props:{currentPage:{type:Number,default:1},pages:{type:Number,default:1}},methods:{changePage:function(t){this.$emit("changePage",t)}}}},57:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var n={name:"Histories",components:{Avatar:a(101).a},props:{title:{type:String,default:"item"},histories:{type:Array,default:function(){return[]}}}},r=a(1),s=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.histories.length?a("div",[a("div",{staticClass:"h5 mb-4"},[t._v("\n    Riwayat Perubahan\n  ")]),t._v(" "),a("ul",{staticClass:"m-0 p-0",staticStyle:{"max-height":"150px",overflow:"auto"}},t._l(t.histories,(function(e,n){return a("li",{key:n,staticClass:"d-flex flex-row mb-3"},[a("Avatar",{staticClass:"mr-3 flex-shrink-0",attrs:{src:e.user.photo}}),t._v(" "),a("div",{staticClass:"d-flex flex-row justify-content-between flex-grow-1"},[a("div",{staticClass:"d-flex flex-column mr-3"},[a("div",[a("span",{staticClass:"font-weight-bolder"},[t._v("\n              "+t._s(e.user.name)+"\n            ")]),t._v(" "),a("span",[t._v("\n              "+t._s(e.change_type_displayed)+"\n            ")]),t._v(" "),a("span",{staticClass:"font-weight-bolder"},[t._v("\n              "+t._s(e.field_name_displayed||t.title)+"\n            ")])]),t._v(" "),e.from||e.to?a("div",{staticClass:"d-flex flox-row text-muted"},[a("div",[t._v(t._s(e.from||"-"))]),t._v(" "),a("div",{staticClass:"mx-3"},[t._v("→")]),t._v(" "),a("div",[t._v(t._s(e.to||"-"))])]):t._e()]),t._v(" "),a("div",{staticClass:"text-secondary flex-shrink-0"},[t._v("\n          "+t._s(t._f("toCompactHumanDateTime")(e.created_at))+"\n        ")])])],1)})),0)]):t._e()}),[],!1,null,null,null).exports},59:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var n={computed:{disabledDueDates:function(){return{to:(t=new Date,e=t.getFullYear(),a=t.getMonth(),n=t.getDate(),r=new Date(0),r.setFullYear(e,a,n-1),r.setHours(23,59,59,999),r)};var t,e,a,n,r}}}},9:function(t,e,a){"use strict";e.a={manage:"manage",supervise:"supervise",report:"report",view:"view"}}}]);